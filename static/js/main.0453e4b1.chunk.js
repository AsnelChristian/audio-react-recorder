(this["webpackJsonpaudio-react-recorder-example"]=this["webpackJsonpaudio-react-recorder-example"]||[]).push([[0],{13:function(t,e,n){},14:function(t,e,n){"use strict";n.r(e);n(4);var r=n(0),a=n.n(r),o=n(2),i=n.n(o),s=n(1),c=n.n(s);function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var l=Object.freeze({START:"start",PAUSE:"pause",STOP:"stop",NONE:"none"}),d=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).init=function(){try{return n.leftchannel=[],n.rightchannel=[],n.recorder=null,n.recording=!1,n.recordingLength=0,n.volume=null,n.audioInput=null,n.sampleRate=null,n.AudioContext=window.AudioContext||window.webkitAudioContext,n.context=null,n.analyser=null,n.canvas=n.canvasRef.current,n.canvasCtx=n.canvas.getContext("2d"),n.stream=null,n.tested=!1,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,Promise.resolve()}catch(t){return Promise.reject(t)}},n.getStream=function(t){return t||(t={audio:!0,video:!1}),navigator.mediaDevices.getUserMedia(t)},n.setUpRecording=function(){n.context=new n.AudioContext,n.sampleRate=n.context.sampleRate,n.volume=n.context.createGain(),n.audioInput=n.context.createMediaStreamSource(n.stream),n.analyser=n.context.createAnalyser(),n.audioInput.connect(n.analyser);n.recorder=n.context.createScriptProcessor(2048,2,2),n.analyser.connect(n.recorder),n.recorder.connect(n.context.destination);var t=u(n);n.recorder.onaudioprocess=function(e){if(t.recording){var n=e.inputBuffer.getChannelData(0),r=e.inputBuffer.getChannelData(1);t.tested||(t.tested=!0,n.reduce((function(t,e){return t+e}))||(console.log("Error: There seems to be an issue with your Mic"),t.stop(),t.stream.getTracks().forEach((function(t){t.stop()})),t.context.close())),t.leftchannel.push(new Float32Array(n)),t.rightchannel.push(new Float32Array(r)),t.recordingLength+=2048}},n.visualize()},n.mergeBuffers=function(t,e){for(var n=new Float32Array(e),r=0,a=t.length,o=0;o<a;o++){var i=t[o];n.set(i,r),r+=i.length}return n},n.interleave=function(t,e){for(var n=t.length+e.length,r=new Float32Array(n),a=0,o=0;o<n;)r[o++]=t[a],r[o++]=e[a],a++;return r},n.writeUTFBytes=function(t,e,n){for(var r=n.length,a=0;a<r;a++)t.setUint8(e+a,n.charCodeAt(a))},n.visualize=function(){var t=n.props,e=t.backgroundColor,r=t.foregroundColor;if(n.WIDTH=n.canvas.width,n.HEIGHT=n.canvas.height,n.CENTERX=n.canvas.width/2,n.CENTERY=n.canvas.height/2,n.analyser){n.analyser.fftSize=2048;var a=n.analyser.fftSize,o=new Uint8Array(a);n.canvasCtx.clearRect(0,0,n.WIDTH,n.HEIGHT);var i=u(n);!function t(){i.drawVisual=requestAnimationFrame(t),i.analyser.getByteTimeDomainData(o),i.canvasCtx.fillStyle=e,i.canvasCtx.fillRect(0,0,i.WIDTH,i.HEIGHT),i.canvasCtx.lineWidth=2,i.canvasCtx.strokeStyle=r,i.canvasCtx.beginPath();for(var n=1*i.WIDTH/a,s=0,c=0;c<a;c++){var u=o[c]/128*i.HEIGHT/2;0===c?i.canvasCtx.moveTo(s,u):i.canvasCtx.lineTo(s,u),s+=n}i.canvasCtx.lineTo(i.canvas.width,i.canvas.height/2),i.canvasCtx.stroke()}()}},n.setupMic=function(){try{var t=function(){n.setUpRecording()},e=function(t,e){try{var n=t()}catch(r){return e(r)}return n&&n.then?n.then(void 0,e):n}((function(){return Promise.resolve(n.getStream()).then((function(t){window.stream=n.stream=t}))}),(function(t){console.log("Error: Issue getting mic",t)}));return Promise.resolve(e&&e.then?e.then(t):t())}catch(r){return Promise.reject(r)}},n.start=function(){try{return Promise.resolve(n.setupMic()).then((function(){n.recording=!0,n.leftchannel.length=n.rightchannel.length=0,n.recordingLength=0}))}catch(t){return Promise.reject(t)}},n.stop=function(){var t=n.props,e=t.onStop,r=t.type;n.recording=!1,n.closeMic(),n.leftBuffer=n.mergeBuffers(n.leftchannel,n.recordingLength),n.rightBuffer=n.mergeBuffers(n.rightchannel,n.recordingLength);var a=n.interleave(n.leftBuffer,n.rightBuffer),o=new ArrayBuffer(44+2*a.length),i=new DataView(o);n.writeUTFBytes(i,0,"RIFF"),i.setUint32(4,44+2*a.length,!0),n.writeUTFBytes(i,8,"WAVE"),n.writeUTFBytes(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,2,!0),i.setUint32(24,n.sampleRate,!0),i.setUint32(28,4*n.sampleRate,!0),i.setUint16(32,4,!0),i.setUint16(34,16,!0),n.writeUTFBytes(i,36,"data"),i.setUint32(40,2*a.length,!0);for(var s=a.length,c=44,u=0;u<s;u++)i.setInt16(c,32767*a[u],!0),c+=2;var l=new Blob([i],{type:r}),d=URL.createObjectURL(l);e&&e({blob:l,url:d,type:r})},n.pause=function(){n.recording=!1,n.closeMic()},n.resume=function(){n.setupMic(),n.recording=!0},n.closeMic=function(){n.stream.getAudioTracks().forEach((function(t){t.stop()})),n.audioInput.disconnect(0),n.analyser.disconnect(0),n.recorder.disconnect(0)},n.canvasRef=a.a.createRef(),n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=r.prototype;return o.componentDidMount=function(){this.init()},o.componentDidUpdate=function(t,e){var n=this.props.state;this.checkState(t.state,n)},o.checkState=function(t){switch(t){case l.START:this.doIfState(l.PAUSE,this.pause),this.doIfState(l.STOP,this.stop);break;case l.PAUSE:this.doIfState(l.START,this.resume),this.doIfState(l.STOP,this.stop);break;case l.STOP:default:this.doIfState(l.START,this.start)}},o.doIfState=function(t,e){this.props.state==t&&e&&e()},o.componentWillUnmount=function(){},o.render=function(){var t=this.props,e=t.canvasWidth,n=t.canvasHeight;return a.a.createElement("div",{className:"audio-react-recorder"},a.a.createElement("canvas",{ref:this.canvasRef,width:e,height:n,className:"audio-react-recorder__canvas"}))},r}(a.a.Component);d.propTypes={state:c.a.string,type:c.a.string.isRequired,backgroundColor:c.a.string,foregroundColor:c.a.string,canvasWidth:c.a.oneOfType([c.a.string,c.a.number]),canvasHeight:c.a.oneOfType([c.a.string,c.a.number]),onStop:c.a.func},d.defaultProps={state:l.NONE,type:"audio/wav",backgroundColor:"rgb(200, 200, 200)",foregroundColor:"rgb(0, 0, 0)",canvasWidth:500,canvasHeight:300};var h=d;n(13);class f extends a.a.Component{constructor(t){super(t),this.start=()=>{this.setState({recordState:l.START})},this.pause=()=>{this.setState({recordState:l.PAUSE})},this.stop=()=>{this.setState({recordState:l.STOP})},this.onStop=t=>{this.setState({audioData:t}),console.log("onStop: audio data",t)},this.state={recordState:null,audioData:null}}render(){var t=this.state.recordState;return a.a.createElement("div",null,a.a.createElement(h,{state:t,onStop:this.onStop,backgroundColor:"rgb(255,255,255)"}),a.a.createElement("audio",{id:"audio",controls:!0,src:this.state.audioData?this.state.audioData.url:null}),a.a.createElement("button",{id:"record",onClick:this.start},"Start"),a.a.createElement("button",{id:"pause",onClick:this.pause},"Pause"),a.a.createElement("button",{id:"stop",onClick:this.stop},"Stop"))}}var p=f;i.a.render(a.a.createElement(p,null),document.getElementById("root"))},3:function(t,e,n){t.exports=n(14)},4:function(t,e,n){}},[[3,1,2]]]);
//# sourceMappingURL=main.0453e4b1.chunk.js.map